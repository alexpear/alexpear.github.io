<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
var WIDTH = 1200;
var HEIGHT = 700;

// Rough draft example version came from http://labs.phaser.io/edit.html?src=src/physics/arcade/mass%20collision%20test.js
var config = {
    type: Phaser.WEBGL,
    width: WIDTH,
    height: HEIGHT,
    parent: 'phaser-example',
    physics: {
        default: 'arcade',
        arcade: {
            useTree: false
        }
    },
    scene: {
        preload: preload,
        create: create,
        update: update
    }
};

var controls;
var player;
var group;
var spriteBounds;
var text;

var game = new Phaser.Game(config);

function preload () {
    this.load.path = 'sprites/';
    this.load.image('soldier', 'fishTankSoldier.png');
    this.load.image('crate', 'assets/sprites/crate.png');
}

function release () {
    for (var i = 0; i < 100; i++)
    {
        var pos = Phaser.Geom.Rectangle.Random(spriteBounds);

        var soldier = group.create(pos.x, pos.y, 'soldier');

        soldier.setBounce(0.9);
        soldier.setCollideWorldBounds(true);
        soldier.setVelocity(0, 0);
        soldier.setMaxVelocity(3000);
        soldier.setBlendMode(1);

        soldier.mind = {
            destination: {
                dims: [
                    Phaser.Math.Between(0, WIDTH),
                    Phaser.Math.Between(0, HEIGHT)
                ]
            }
        };
    }

    text.setText('Total: ' + group.getLength());
}

function create () {
    var graphics = this.add.graphics();
    graphics.fillStyle(0x000044);

    this.physics.world.setBounds(0, 0, WIDTH, HEIGHT);

    spriteBounds = Phaser.Geom.Rectangle.Inflate(Phaser.Geom.Rectangle.Clone(this.physics.world.bounds), -10, -200);
    spriteBounds.y += 100;

    group = this.physics.add.group();
    group.runChildUpdate = false;

    this.time.addEvent({ delay: 500, callback: release, callbackScope: this});

    cursors = this.input.keyboard.createCursorKeys();

    player = this.physics.add.image(400, 100, 'crate');

    player.setCollideWorldBounds(true);

    this.physics.add.collider(player, group);

    text = this.add.text(10, 10, 'Total: 0', { font: '16px Courier', fill: '#ffffff' });
}

function update () {
    // See example: http://labs.phaser.io/edit.html?src=src/games/topdownShooter/topdown_combatMechanics.js

    player.setVelocity(0);

    if (cursors.left.isDown)
    {
        player.setVelocityX(-500);
    }
    else if (cursors.right.isDown)
    {
        player.setVelocityX(500);
    }

    if (cursors.up.isDown)
    {
        player.setVelocityY(-500);
    }
    else if (cursors.down.isDown)
    {
        player.setVelocityY(500);
    }
}

    </script>

</body>
</html>